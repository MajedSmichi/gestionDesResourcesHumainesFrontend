<main class="content">
  <div class="container-fluid p-0">
    <div class="mb-3">
      <h1 class="h3 d-inline align-middle">Profile</h1>
    </div>
    <div class="row">
      <div class="col-md-4 col-xl-3">
        <div class="card mb-3">
          <div class="card-header">
            <h5 class="card-title mb-0">Profile Details</h5>
          </div>
          <div class="card-body text-center">
            <img [src]="user?.photo" class="avatar img-fluid rounded-circle me-1"
                 alt="{{ user?.nom || '' }} {{ user?.prenom || '' }}"
                 style="width: 100px; height: 100px; object-fit: cover;">
            <h5 class="card-title mb-0">{{ user?.nom || '' }} {{ user?.prenom || '' }}</h5>
            <div class="text-muted mb-2">{{ user?.postes?.[0]?.posteType }}</div>
            <div>
              <a class="btn btn-primary btn-sm" href="#">Follow</a>
              <a class="btn btn-primary btn-sm" href="#"><span data-feather="message-square"></span> Message</a>
            </div>
          </div>
          <hr class="my-0"/>
          <div class="card-body">
            <h5 class="h6 card-title">Skills</h5>
            <a href="#" class="badge bg-primary me-1 my-1">HTML</a>
            <a href="#" class="badge bg-primary me-1 my-1">JavaScript</a>
            <a href="#" class="badge bg-primary me-1 my-1">Sass</a>
            <a href="#" class="badge bg-primary me-1 my-1">Angular</a>
            <a href="#" class="badge bg-primary me-1 my-1">Vue</a>
            <a href="#" class="badge bg-primary me-1 my-1">React</a>
            <a href="#" class="badge bg-primary me-1 my-1">Redux</a>
            <a href="#" class="badge bg-primary me-1 my-1">UI</a>
            <a href="#" class="badge bg-primary me-1 my-1">UX</a>
          </div>
          <hr class="my-0"/>
          <div class="card-body">
            <h5 class="h6 card-title">About</h5>
            <ul class="list-unstyled mb-0">
              <li class="mb-1"><span data-feather="home" class="feather-sm me-1"></span> Lives in <a href="#">San
                Francisco, SA</a></li>
              <li class="mb-1"><span data-feather="briefcase" class="feather-sm me-1"></span> Works at <a href="#">GitHub</a>
              </li>
              <li class="mb-1"><span data-feather="map-pin" class="feather-sm me-1"></span> From <a href="#">Boston</a>
              </li>
            </ul>
          </div>
          <hr class="my-0"/>
          <div class="card-body">
            <h5 class="h6 card-title">Elsewhere</h5>
            <ul class="list-unstyled mb-0">
              <li class="mb-1"><a href="#">staciehall.co</a></li>
              <li class="mb-1"><a href="#">Twitter</a></li>
              <li class="mb-1"><a href="#">Facebook</a></li>
              <li class="mb-1"><a href="#">Instagram</a></li>
              <li class="mb-1"><a href="#">LinkedIn</a></li>
            </ul>
          </div>
        </div>
      </div>

      <div class="col-md-8 col-xl-9">
        <div class="card">
          <div class="card-header">
            <h5 class="card-title mb-0">Update Profile</h5>
          </div>
          <div class="card-body h-100">
            <form #form="ngForm">
              <div class="row">
                <div class="col-12 col-md-6 mb-3">
                  <label for="nom" class="form-label">Nom</label>
                  <input type="text" class="form-control" id="nom" name="nom" [(ngModel)]="tempUser.nom"
                         [disabled]="!isEditMode" required (ngModelChange)="clearError('nom')">
                  <div *ngIf="errors.nom" class="text-danger">{{ errors.nom }}</div>
                </div>
                <div class="col-12 col-md-6 mb-3">
                  <label for="prenom" class="form-label">Prenom</label>
                  <input type="text" class="form-control" id="prenom" name="prenom" [(ngModel)]="tempUser.prenom"
                         [disabled]="!isEditMode" required (ngModelChange)="clearError('prenom')">
                  <div *ngIf="errors.prenom" class="text-danger">{{ errors.prenom }}</div>
                </div>
              </div>
              <div class="row">
                <div class="col-12 col-md-6 mb-3">
                  <label for="email" class="form-label">Email</label>
                  <input type="email" class="form-control" id="email" name="email" [(ngModel)]="tempUser.email"
                         [disabled]="!isEditMode" required (ngModelChange)="clearError('email')">
                  <div *ngIf="errors.email" class="text-danger">{{ errors.email }}</div>
                </div>
                <div class="col-12 col-md-6 mb-3">
                  <label for="telephone" class="form-label">Telephone</label>
                  <input type="tel" class="form-control" id="telephone" name="telephone"
                         [(ngModel)]="tempUser.telephone" [disabled]="!isEditMode" required
                         (ngModelChange)="clearError('telephone')">
                  <div *ngIf="errors.telephone" class="text-danger">{{ errors.telephone }}</div>
                </div>
              </div>
              <div class="row">
                <div class="col-12 col-md-6 mb-3">
                  <label for="poste" class="form-label">Poste</label>
                  <select class="form-control" id="poste" name="poste" [(ngModel)]="selectedPoste" required
                          (ngModelChange)="clearError('poste')" disabled>
                    <option *ngFor="let poste of postes" [value]="poste">{{ poste }}</option>
                  </select>
                  <div *ngIf="errors.poste" class="text-danger">{{ errors.poste }}</div>
                </div>
                <div class="col-12 col-md-6 mb-3">
                  <label for="role" class="form-label">Roles</label>
                  <select class="form-control" id="role" name="role" [(ngModel)]="selectedRole" required
                          (ngModelChange)="clearError('role')" disabled>
                    <option *ngFor="let role of roles" [value]="role">{{ role }}</option>
                  </select>
                  <div *ngIf="errors.role" class="text-danger">{{ errors.role }}</div>
                </div>
              </div>
              <div class="row">
                <div class="col-12 col-md-6 mb-3">
                  <label for="fonction" class="form-label">Fonction</label>
                  <select class="form-control" id="fonction" name="fonction" [(ngModel)]="selectedFonction" required
                          (ngModelChange)="clearError('fonction')" disabled>
                    <option *ngFor="let fonction of fonctions" [value]="fonction">{{ fonction }}</option>
                  </select>
                  <div *ngIf="errors.fonction" class="text-danger">{{ errors.fonction }}</div>
                </div>
                <div class="col-12 col-md-6 mb-3">
                  <label for="soldeDeConge" class="form-label">Solde de Congé</label>
                  <input type="number" class="form-control" id="soldeDeConge" name="soldeDeConge"
                         [(ngModel)]="tempUser.soldeConges" required (ngModelChange)="clearError('soldeDeConge')"
                         disabled>
                  <div *ngIf="errors.soldeDeConge" class="text-danger">{{ errors.soldeDeConge }}</div>
                </div>
              </div>
              <div class="row">
                <div class="col-12 col-md-6 mb-3">
                  <label for="dateCreation" class="form-label">Date de Création</label>
                  <input type="text" class="form-control" id="dateCreation" name="dateCreation"
                         [value]="formatDate(user?.dateCreation)" disabled>
                </div>
                <div class="col-12 col-md-6 mb-3">
                  <label for="dateUpdate" class="form-label">Date de Mise à Jour</label>
                  <input type="text" class="form-control" id="dateUpdate" name="dateUpdate"
                         [value]="formatDate(user?.dateUpdate)" disabled>
                </div>
              </div>
            </form>
            <div class="button-group mt-3 d-flex justify-content-center">
              <button (click)="toggleEditMode(form)"
                      class="btn btn-outline-primary btn-md btn-center w-50">{{ editButtonText }}
              </button>
            </div>
            <hr class="my-4">
            <div class="card mb-4">
              <div class="card-header">
                <h5 class="card-title mb-0">Update Password</h5>
              </div>
              <div class="card-body">
                <!-- Formulaire de mise à jour du mot de passe -->
                  <form #passwordForm="ngForm" (ngSubmit)="updatePassword(passwordForm)">
                    <div class="mb-3">
                      <label for="currentPassword" class="form-label">Current Password</label>
                      <input type="password" class="form-control" id="currentPassword" name="currentPassword" [(ngModel)]="currentPassword" required
                             (focus)="clearPasswordError('currentPassword')">
                      <div *ngIf="passwordErrors.currentPassword" class="text-danger">{{ passwordErrors.currentPassword }}</div>
                      <div *ngIf="passwordErrors1.currentPassword" class="text-danger">{{ passwordErrors1.currentPassword }}</div>
                    </div>
                    <div class="mb-3">
                      <label for="newPassword" class="form-label">New Password</label>
                      <input type="password" class="form-control" id="newPassword" name="newPassword" [(ngModel)]="newPassword" required
                             (focus)="clearPasswordError('newPassword')">
                      <div *ngIf="passwordErrors.newPassword" class="text-danger">{{ passwordErrors.newPassword }}</div>
                    </div>
                    <div class="mb-3">
                      <label for="confirmPassword" class="form-label">New Password Confirm</label>
                      <input type="password" class="form-control" id="confirmPassword" name="confirmPassword" [(ngModel)]="confirmPassword" required
                             (focus)="clearPasswordError('confirmPassword')">
                      <div *ngIf="passwordErrors.confirmPassword" class="text-danger">{{ passwordErrors.confirmPassword }}</div>
                      <div *ngIf="passwordErrors1.confirmPassword" class="text-danger">{{ passwordErrors1.confirmPassword }}</div>
                    </div>
                    <div *ngIf="successMessage" class="alert alert-success">{{ successMessage }}</div>
                    <div class="button-group mt-3 d-flex justify-content-center">
                    <button type="submit" class="btn btn-outline-primary btn-md btn-center w-50">Update your Pwd</button>
                    </div>
                  </form>

              </div>

            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</main>
